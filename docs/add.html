<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>예약 리스트 추가</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <h1>예약 리스트 추가</h1>
    <select id="region">
        <option value="">지역 선택</option>
        <option>서울/인천/경기</option>
        <option>강원</option>
        <option>충북</option>
        <option>대전/충남</option>
        <option>전북</option>
        <option>광주/전남</option>
        <option>대구/경북</option>
        <option>부산/경남</option>
        <option>제주</option>
    </select>
    <input type="text" id="dateInput" class="select-input" placeholder="날짜 선택" readonly onclick="showCalendar()">
    <div class="calendar-popup" id="calendar"></div>
    <button class="btn" onclick="saveItem()">저장</button>
    <a href="index.html" class="btn btn-gray">뒤로</a>
</div>
<script src="script.js"></script>
<script>
let chosenDate = "";
let currentMonth = new Date().getMonth();
let currentYear = new Date().getFullYear();

function showCalendar() {
    renderCalendar(currentYear, currentMonth);
    document.getElementById('calendar').style.display = 'block';
}

function renderCalendar(year, month) {
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    const firstDay = new Date(year, month, 1).getDay();
    let html = `
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
            <button onclick="prevMonth()">◀</button>
            <span><b>${year}년 ${month + 1}월</b></span>
            <button onclick="nextMonth()">▶</button>
        </div>
        <table>
            <tr><th>일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th></tr>
            <tr>
    `;
    for (let i = 0; i < firstDay; i++) html += "<td></td>";
    for (let d = 1; d <= daysInMonth; d++) {
        if ((firstDay + d - 1) % 7 === 0 && d !== 1) html += "</tr><tr>";
        html += `<td onclick="pick(${d})">${d}</td>`;
    }
    html += "</tr></table>";
    document.getElementById('calendar').innerHTML = html;
}

function prevMonth() {
    currentMonth--;
    if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
    }
    renderCalendar(currentYear, currentMonth);
}
function nextMonth() {
    currentMonth++;
    if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
    }
    renderCalendar(currentYear, currentMonth);
}

function pick(day) {
    chosenDate = `${currentYear}-${String(currentMonth + 1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
    document.getElementById('dateInput').value = chosenDate;
    document.getElementById('calendar').style.display = 'none';
}

async function saveItem() {
    const region = document.getElementById('region').value;
    if (!region || !chosenDate) return alert('지역과 날짜를 선택하세요.');
    const data = await fetchData();
    if (data.length >= 15) return alert('최대 15개까지 가능');
    data.push({ region, date: chosenDate });
    const success = await updateData(data);
    if (success) {
        alert("✅ 예약 추가 완료");
        location.href = 'index.html';
    }
}
</script>
</body>
</html>
